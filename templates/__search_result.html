{% extends "base.html" %}
{% load static %}
    {% block title %}PhoneCab - Risultati ricerca{% endblock %}
    {% block application %}
    <div class="colmain">
    <div id="anagrafica">
       <h2>Risultati della ricerca</h2>
       <div class="main" style="width:75%;">
       <h3>Anagrafiche</h3>
       {% if anagrafiche %}
        <table cellspacing="0" cellpadding="4" border="0" class="table table-striped">
            <tr>
            <th style="width:360px;">Cognome Nome (Codice)</th>
            <th style="width:100px;">Matricola</th>
            <th style="width:60px;">Stato</th>
            <th style="width:auto;text-align:center;">Azioni</th>
            </tr>
            {% for anagrafica in anagrafiche %}
            <tr>
            <td><i class="icon-file"></i>{{ anagrafica.last_name }} {{ anagrafica.first_name }} ({{ anagrafica.pincode }})</td>
            <td>{{ anagrafica.serial_no}}</td>
            <td>{{ anagrafica.enabled|yesno:"Attivo,Disattivo"}}</td>
            <td style="text-align:center;">
                <a href="/phoneusers/view/{{ anagrafica.id }}" class="btn btn-primary btn-mini"><i class="icon-white icon-zoom-in"></i> visualizza</a>
                {% if priv_whitelist > 1 and false %}   
                <a href="#myModal" class="btn btn-success btn-mini new-whitelist" data-id="{{ anagrafica.id }}"data-toggle="modal" data-dynamic="true"><i class="icon-white icon-plus"></i> whitelist</a>
                {% endif %}
                {% if priv_credit > 1 and false %}
                <a href="#myModal" class="btn btn-warning btn-mini new-credit" data-id="{{ anagrafica.id }}" data-toggle="modal" data-dynamic="true"><i class="icon-white icon-plus"></i> ricarica</a>
                {% endif %}
                {% if priv_cdr > 0 %}
                <a href="#" class="btn btn-info btn-mini show-cdr" data-id="{{ anagrafica.pincode }}" data-toggle="modal" data-dynamic="true"><i class="icon-white icon-asterisk"></i> chiamate</a>
                {% endif %}
                {% if priv_record > 0 %}
                <a href="#" class="btn btn-info btn-mini show-record" data-id="{{ anagrafica.pincode }}" data-toggle="modal" data-dynamic="true"><i class="icon-white icon-headphones"></i> registrazioni</a>
                {% endif %}
            </td>
            </tr>
            {% endfor %}
        </table>
        <!-- paginazione cdr -->
        <div class="pagination pagination-right">
            {{ start_item }} - {{ end_item }} di {{ total_items }}&nbsp;&nbsp;
            <a href="?page={{ prev_page }}&{{ query_string }}" class="btn prev-page {{ prev_page_disabled }}"><i class="icon-chevron-left prev-page"> </i></a>
           <a href="?page={{ next_page }}&{{ query_string }}" class="btn next-page {{ next_page_disabled }}"><i class="icon-chevron-right next-page"> </i></a>
        <input type="hidden" id="items-current-page" value="{{ current_page }}"></input>
        </div>
        <div style="height:30px;"><a href="/cdrs/export/excel/?{{ query_string }}" class="btn btn-success" style="float:left;">Esporta dati</a></div>
        {% else %}
            <p style="border-top: 1px dashed #CCCCCC;">Non ci sono anagrafiche corrispondenti alla ricerca effettuata.</p>
        {% endif %}
        
        {% if user.is_staff %}
            <br>
            <h3>Anagrafiche Archiviate</h3>
            {% if archives %}
            <table cellspacing="0" cellpadding="4" border="0" class="table table-striped">
                <tr>
                <th style="width:360px;">Cognome Nome (Codice)</th>
                <th style="width:60px;">Matricola</th>
                <th style="width:auto;text-align:center;">Azioni</th>
                </tr>
                {% for archive in archives %}
                <tr>
                <td><i class="icon-file"></i>{{ archive.last_name }} {{ archive.first_name }} ({{ archive.pincode }})</td>
                <td>{{ archive.serial_no}}</td>
                <td style="text-align:center;">
                    <a href="/archives/phoneusers/{{ archive.id }}" class="btn btn-primary btn-mini"><i class="icon-white icon-zoom-in"></i> visualizza</a>
                    {% if priv_cdr > 0 %}
                    <a href="/archives/cdrs/{{ archive.id }}" class="btn btn-info btn-mini"><i class="icon-white icon-asterisk"></i> chiamate</a>
                    {% endif %}
                    {% if priv_record > 0 %}
                    <a href="/archives/records/{{ archive.id }}" class="btn btn-info btn-mini"><i class="icon-white icon-headphones"></i> registrazioni</a>
                    {% endif %}
                </td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
                <p style="border-top: 1px dashed #CCCCCC;">Non ci sono anagrafiche archiviate corrispondenti alla ricerca effettuata.</p>
            {% endif %}
            <br>
            <h3>Utenti</h3>
            {% if utenti %}
            <table cellspacing="0" cellpadding="4" border="0" class="table table-striped">
                <tr>
                <th style="width:auto;">Nome Cognome (username)</th>
                <th style="width:260px;text-align:center;">Azioni</th>
                </tr>
                {% for utente in utenti %}
                <tr>
                <td><i class="icon-user"></i> {{ utente.first_name}} {{ utente.last_name }} ({{ utente.username }})</td>
                <td style="text-align:center;">
                    <a href="#myModal" class="btn btn-primary btn-mini edit-user" data-id="{{ utente.id }}" data-toggle="modal" data-dynamic="true"><i class="icon-white icon-pencil"></i> modifica</a>
                    <a href="#myModal" class="btn btn-danger btn-mini" id="confirm-remove-user" data-id="{{ utente.id }}" data-toggle="modal" data-dynamic="true"><i class="icon-white icon-remove"></i> Elimina</a>
                    </td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
            <p style="border-top: 1px dashed #CCCCCC;">Non ci sono utenti corrispondenti alla ricerca effettuata.</p>
            {% endif %}
        {% endif %}    
            
        </div>
     </div>
    </div>
    {% endblock application %}
    {% block script %}
     <script src="{% static "js/anagrafica.js" %}" type="text/javascript" charset="utf-8"></script>
    {% endblock script %}